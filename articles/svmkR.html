<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>An end-to-end survey research workflow with svmkR • svmkR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Lato-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="An end-to-end survey research workflow with svmkR">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">svmkR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/svmkR.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/qdocs.html">How to format your questionnaire document</a></li>
    <li><a class="dropdown-item" href="../articles/weights.html">How to weight your survey</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>An end-to-end survey research workflow with svmkR</h1>
            
      

      <div class="d-none name"><code>svmkR.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install the stable version of <code>svmkR</code> from GitHub:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"soubhikbarari/svmkR"</span><span class="op">)</span></span></code></pre></div>
<p>To install the development version of <code>svmkR</code> from
GitHub:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"soubhikbarari/svmkR@dev"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="authentication">Authentication<a class="anchor" aria-label="anchor" href="#authentication"></a>
</h2>
<p>Before going any further you’ll need an OAuth token, and for that
you’ll need to set up an app on the SurveyMonkey Developer portal.</p>
<ol style="list-style-type: decimal">
<li><p><strong>Navigate to SurveyMonkey Developer portal.</strong> Log
in to SurveyMonkey in your browser, then navigate to <a href="https://developer.surveymonkey.com/apps" class="external-link uri">https://developer.surveymonkey.com/apps</a>.</p></li>
<li><p><strong>Create an app.</strong> It should be private, and you
should enable the relevant scopes: Create/Modify Surveys, View Surveys,
View Collectors, View Contacts, View Responses, View Response Details.
You don’t need to click “deploy”, as long as the setting selected have
been updated you’re set.</p></li>
<li><p><strong>Copy access token.</strong> Look at the settings page for
your app and take note of the “Access Token” field, which should contain
a very long character string.</p></li>
<li><p><strong>Add to R environment.</strong> Add the SurveyMonkey
account’s OAuth token to your .Rprofile file. To open and edit that
file, run <code>usethis::edit_r_profile()</code>, then add a line like
this:
<code>options(sm_oauth_token = "MY-OAUTH-TOKEN-FROM-STEP-3")</code>.</p></li>
<li><p><strong>Test that it works.</strong> Restart R for changes to
take effect. If this is all set up successfully, the token will print
when you run <code>getOption("sm_oauth_token")</code>. Guard this token:
don’t share it and don’t commit it in any repository.</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h2>
<p>The following demonstrates how to write a SurveyMonkey workflow that
covers four major steps in survey research: survey creation, response
downloading/parsing, weighting, and banner creation.</p>
<div class="section level3">
<h3 id="create-a-survey">Create a survey<a class="anchor" aria-label="anchor" href="#create-a-survey"></a>
</h3>
<p>When creating a survey, you typically start with writing up the
questionnaire. Once this is done you have two options:</p>
<ol style="list-style-type: decimal">
<li>Program the survey in the SurveyMonkey platform itself</li>
<li>Automatically parse your questionnaire and upload to SurveyMonkey
with <code>svmkR</code>.</li>
</ol>
<p>The second option is possible with the help of QDOC, a questionnaire
syntax we have developed to mark up your questionnaire document and make
it machine readable. See the related <code><a href="../articles/qdocs.html">vignette("qdocs")</a></code> for
details.</p>
<p>A example QDOC (written in the simple, less verbose format) might
start off like this:</p>
<pre><code>1. How familiar are you with SurveyMonkey?
[[Choices]]
Very familiar
Somewhat familiar
Not so familiar
Not at all familiar

2. How well do each of the following terms apply to SurveyMonkey? [[Matrix]]
[[Rows]]
High-quality
Innovative
Trustworthy
Fun
Easy to use
Fast
Flexible
Powerful
Cost-efficient
[[Columns]]
Very well
Somewhat well
Not so well
Not at all well</code></pre>
<p>See <code>data("qdocs")</code> for more examples.</p>
<p>Once your questionnaire is marked up with the QDOC, you can read it
in:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># if it's a local file</span></span>
<span><span class="va">qdoc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_qdoc.html">read_qdoc</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"my_qdoc.txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># if it's a Google Doc</span></span>
<span><span class="va">qdoc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_qdoc.html">read_qdoc</a></span><span class="op">(</span>gdoc <span class="op">=</span> <span class="va">my_qdoc_url</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># if it's a character string</span></span>
<span><span class="va">qdoc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_qdoc.html">read_qdoc</a></span><span class="op">(</span>text <span class="op">=</span> <span class="va">my_qdoc</span><span class="op">)</span></span></code></pre></div>
<p>Check that it conforms to expectation by printing it.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">qdoc</span><span class="op">)</span></span></code></pre></div>
<p>This should step through each question and show you the format that
it has been parsed into. If there are any unexpected results, check any
warnings raised from <code>read_qdoc</code> or revise the original
QDOC.</p>
</div>
<div class="section level3">
<h3 id="upload-your-survey">Upload your survey<a class="anchor" aria-label="anchor" href="#upload-your-survey"></a>
</h3>
<p>Once you’re happy with your QDOC, you can go ahead and upload it to
your account with a particular title.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/upload_qdoc.html">upload_qdoc</a></span><span class="op">(</span><span class="va">qdoc</span>, title <span class="op">=</span> <span class="st">"My Survey"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="browse-your-surveys">Browse your surveys<a class="anchor" aria-label="anchor" href="#browse-your-surveys"></a>
</h3>
<p>To find the ID number of your survey in your account, you can browse
your surveys like this:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">surveys</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/browse_surveys.html">browse_surveys</a></span><span class="op">(</span><span class="fl">200</span><span class="op">)</span> <span class="co"># see your most recent 200 surveys</span></span></code></pre></div>
<p>An easy way to retrieve the ID number is to run
<code>View(surveys)</code> and start typing the name of the survey you
want into the search window at the top right of the RStudio data.frame
viewer.</p>
<p>That will get you the survey’s ID number. Copy it.</p>
</div>
<div class="section level3">
<h3 id="download-survey-responses">Download survey responses<a class="anchor" aria-label="anchor" href="#download-survey-responses"></a>
</h3>
<p>Once you’ve fielded your survey (currently can only be done on the
SurveyMonkey platform), download the survey responses by first
downloading the raw survey:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a_survey_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fetch_survey_obj.html">fetch_survey_obj</a></span><span class="op">(</span><span class="fl">123456789</span><span class="op">)</span> <span class="co"># your survey's ID goes here</span></span></code></pre></div>
<p>This first step returns a list of metadata about the survey. To
actually download and parse the responses, use the following:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">survey_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse_survey.html">parse_survey</a></span><span class="op">(</span><span class="va">a_survey_obj</span><span class="op">)</span></span></code></pre></div>
<p>That will give you a tidy data.frame with all of your responses.</p>
<p>In the future you can run it all as one command:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">survey_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fetch_survey_obj.html">fetch_survey_obj</a></span><span class="op">(</span><span class="fl">123456789</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/parse_survey.html">parse_survey</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="estimate-margin-of-error">Estimate margin of error<a class="anchor" aria-label="anchor" href="#estimate-margin-of-error"></a>
</h3>
<p>There are two twin functions you can use to estimate <a href="https://en.wikipedia.org/wiki/Margin_of_error" class="external-link">margin of error</a>
(MOE) for your survey.</p>
<ul>
<li>Estimate the MOE using an asymptotic formula
(<code><a href="../reference/esti_moe.html">esti_moe()</a></code>)</li>
<li>Simulate the MOE using non-parametric bootstraps
(<code><a href="../reference/simu_moe.html">simu_moe()</a></code>)</li>
</ul>
<p>Both incorporate any weights estimated for the survey.</p>
<p>Here’s an example using some dummy data included in the package:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ev22</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/esti_moe.html">esti_moe</a></span><span class="op">(</span><span class="va">ev22</span><span class="op">$</span><span class="va">weight_genpop</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/simu_moe.html">simu_moe</a></span><span class="op">(</span><span class="va">ev22</span><span class="op">$</span><span class="va">weight_genpop</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="weight-your-survey">Weight your survey<a class="anchor" aria-label="anchor" href="#weight-your-survey"></a>
</h3>
<p>You may be interested in re-weighting your survey responses to a
specific <strong>target population</strong>. To see a list of available
populations, you can run:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/list_targets.html">list_targets</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Once you find a named target suitable for your application you can
read it into a target object. You can then print it out and it will step
through each distribution, either marginal (one variable) or joint
(multiple variables), specified in the target.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tgt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_target.html">get_target</a></span><span class="op">(</span><span class="st">"us_genpop_acs19"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tgt</span><span class="op">)</span></span></code></pre></div>
<p>Note: if you have an <em>existing</em> list of joint and marginal
distributions, you can also use this as your weighting target.</p>
<p>We can then simply run <code>weight_to</code> using our survey
dataframe (the <code>smda23</code> example dataset used below) and our
population target.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"smda23"</span><span class="op">)</span></span>
<span><span class="va">wtd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/weight_to.html">weight_to</a></span><span class="op">(</span><span class="va">smda23</span>, target <span class="op">=</span> <span class="va">tgt</span><span class="op">)</span></span></code></pre></div>
<p>A bunch of informative output will be displayed when running this
function that should help you determine whether (a) the automated
mapping of columns in the survey dataset to variables in the target
object was successful and (b) the quality of your weights is
satisfactory.</p>
<p>For more helpful guidance on how to weight your surveys, see
<code><a href="../articles/weights.html">vignette("weights")</a></code>.</p>
</div>
<div class="section level3">
<h3 id="create-banners">Create banners<a class="anchor" aria-label="anchor" href="#create-banners"></a>
</h3>
<p>Banners are the bread and butter of the SurveyMonkey Research
Insights Team.</p>
<p>To see how the <code>svmkR</code> package can do this, check out the
examples in <code><a href="../reference/make_banners.html">make_banners()</a></code> and
<code><a href="../reference/write_banners.html">write_banners()</a></code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="api-considerations">API Considerations<a class="anchor" aria-label="anchor" href="#api-considerations"></a>
</h2>
<p>Your account will likely be limited to 500 hits per day to the API.
This package will print reminders of how many calls you have left in the
day.</p>
<p>The main thing to keep an eye on is respondent counts; as only 100
responses can be fetched per API call, a survey with X respondents will
make at least X/100 calls to the API.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Soubhik Barari.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
